<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>麦克风测试</title>
</head>
<body>
<h1>麦克风测试</h1>
<button id="startBtn">开启麦克风</button>

<script>
    const startBtn = document.getElementById('startBtn');
    let stream = null;
    startBtn.addEventListener('click', async () => {
        try {
            // 请求麦克风权限
            stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            console.log('麦克风已开启');
            // 可以在这里对 stream 进行处理，比如播放音频或录音
        } catch (err) {
            console.error('无法开启麦克风:', err);
            alert('无法开启麦克风，请检查权限设置。');
        }
    });

    const stopBtn = document.getElementById('stopBtn');

    stopBtn.addEventListener('click', async () => {
        try {
              const tracks = stream.getTracks();
              tracks.forEach(function (track) {
                track.stop();
              });
        } catch (err) {
            console.error('无法开启麦克风:', err);
            alert('无法开启麦克风，请检查权限设置。');
        }
    });
</script>
</body>
</html>