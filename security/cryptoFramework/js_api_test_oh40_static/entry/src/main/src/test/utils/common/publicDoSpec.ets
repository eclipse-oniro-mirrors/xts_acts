/*
 * Copyright (C) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import cryptoFramework from "@ohos.security.cryptoFramework";

function genEccCommonSpec(): cryptoFramework.ECCCommonParamsSpec {
  let fieldFp: cryptoFramework.ECFieldFp = {
    fieldType: "Fp",
    p: BigInt("26959946667150639794667015087019630673557916260026308143510066298881"),
  };

  let G: cryptoFramework.Point = {
    x: BigInt("19277929113566293071110308034699488026831934219452440156649784352033"),
    y: BigInt("19926808758034470970197974370888749184205991990603949537637343198772"),
  };

  let eccCommonSpec: cryptoFramework.ECCCommonParamsSpec = {
    algName: "ECC",
    specType: cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC,
    field: fieldFp,
    a: BigInt("26959946667150639794667015087019630673557916260026308143510066298878"),
    b: BigInt("18958286285566608000408668544493926415504680968679321075787234672564"),
    g: G,
    n: BigInt("26959946667150639794667015087019625940457807714424391721682722368061"),
    h: 1,
  };
  return eccCommonSpec;
}

// 根据keyType（类型为AsyKeySpecType）生成spec
function genEccKeySpec(keyType: cryptoFramework.AsyKeySpecType): cryptoFramework.AsyKeySpec {
  let eccCommonSpec: cryptoFramework.ECCCommonParamsSpec = genEccCommonSpec();
  let p: cryptoFramework.Point = {
    x: BigInt("4895532085604793194575786155111833270332983059222328855174278400474"),
    y: BigInt("4723326229663867361666299745656506249666895013633470733286602151299"),
  };
  switch (keyType) {
    case cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC:
      return eccCommonSpec;
    case cryptoFramework.AsyKeySpecType.PRIVATE_KEY_SPEC:
      let eccPriKeySpec: cryptoFramework.ECCPriKeySpec = {
        algName: "ECC",
        specType: cryptoFramework.AsyKeySpecType.PRIVATE_KEY_SPEC,
        params: eccCommonSpec,
        sk: BigInt("3344909136015722512027436098545989769510126495932393934480943836086"),
      };
      return eccPriKeySpec;
    case cryptoFramework.AsyKeySpecType.PUBLIC_KEY_SPEC:
      let eccPubKeySpec: cryptoFramework.ECCPubKeySpec = {
        algName: "ECC",
        specType: cryptoFramework.AsyKeySpecType.PUBLIC_KEY_SPEC,
        params: eccCommonSpec,
        pk: p,
      };
      return eccPubKeySpec;
    case cryptoFramework.AsyKeySpecType.KEY_PAIR_SPEC:
      let eccKeyPairSpec: cryptoFramework.ECCKeyPairSpec = {
        algName: "ECC",
        specType: cryptoFramework.AsyKeySpecType.KEY_PAIR_SPEC,
        params: eccCommonSpec,
        sk: BigInt("2800624119486068255700441023186688273480420054409813794688121797911"),
        pk: p,
      };
      return eccKeyPairSpec;
  }

  return eccCommonSpec;
}

// DSA2048 spec大端common数据
function genDsa2048CommonSpecBigE(): cryptoFramework.DSACommonParamsSpec {
  let dsaCommonSpec: cryptoFramework.DSACommonParamsSpec = {
    algName: "DSA",
    specType: cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC,
    p: BigInt(
      "20216857044408199932376494764599580727974045843915439721502938327198864725169044809813204952147752413624701213316563574475039748055346468178028625826092035313601316397655587341814674633664886284528623285325653023780498382484985239780177599233965758919159102159171718273864148712746797113414042595739717319731696609579150841956081703573371531465350272238016149836326224001841088360384367898447054044508716751610019070103182911963258176168025828573385356097755187338108832184592810352254309012721096301415240345204182050921863355546837078288047550266434252240460770780823402663658159753063957196734025229736568089530267"
    ),
    q: BigInt("867213547744821940284222002039163947454712583963"),
    g: BigInt(
      "5613702672530613039214328932450936898231965110898797142283557379865685939526291625923546497805448201404435739446597666135884235480978009652818140400499199787725528596067079382996609708472937555140407402057536621734502472274147757401975812355605352555485852816071445663853971471514294654628089019755771069636793509413303062371896404562622361502073164175883230960631373093173990688756272270068057277748993274083763062285503458176853646465605466871218985585055660513268314836972803355963121806305145618647016398490455324285041057243421484005529145312291069828934043829252492089834817718429184649225777566648238469211448"
    ),
  };
  return dsaCommonSpec;
}

// DSA2048 spec大端KeyPair数据
function genDsa2048KeyPairSpecBigE(): cryptoFramework.DSAKeyPairSpec {
  let dsaCommonSpec: cryptoFramework.DSACommonParamsSpec = genDsa2048CommonSpecBigE();
  let dsaKeyPairSpec: cryptoFramework.DSAKeyPairSpec = {
    algName: "DSA",
    specType: cryptoFramework.AsyKeySpecType.KEY_PAIR_SPEC,
    params: dsaCommonSpec,
    sk: BigInt("287759317661555678461170451498783134028435263911"),
    pk: BigInt(
      "2974320683131303383593011718103778438067248821010128068603330890682877434550441281827351603361334506610914048116228047158214093207291532728181748676811787843316027859373324322706845202765204260289964362553170484033902517855022371250354897430992714094652148720967777508481265194493537489752556929433399052957551421373353304195295773950194626096020536543310165869112300390873999312126377909122302697760566740696966174036865456319235321580616931347110147760623816495949862659419251353007558185295016129505360845025009080058771674461404631229857893492589646335484050582997233310521320078311463229120799046072712830367694"
    ),
  };
  return dsaKeyPairSpec;
}

// DSA2048 spec大端KeyPair数据
function genDsaKeyPairSpec(dsap: bigint | string | int,
  dsaq: bigint | string | int, dsag: bigint | string | int, sk: bigint, pk: bigint): cryptoFramework.DSAKeyPairSpec {
  let dsaCommonSpec: cryptoFramework.DSACommonParamsSpec = genDsa2048CommonSpecBigE();
  let dsaKeyPairSpec: cryptoFramework.DSAKeyPairSpec = {
    algName: "DSA",
    specType: cryptoFramework.AsyKeySpecType.KEY_PAIR_SPEC,
    params: dsaCommonSpec,
    sk: sk,
    pk: pk //,
    // p: dsap,
    // q: dsaq,
    // g: dsag,
  };
  return dsaKeyPairSpec;
}

function genRsaKeyPairSpec(nIn: bigint, eIn: bigint, dIn: bigint): cryptoFramework.RSAKeyPairSpec {
  let rsaCommSpec: cryptoFramework.RSACommonParamsSpec = {
    n: nIn,
    algName: "RSA",
    specType: cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC,
  };
  let rsaKeyPairSpec: cryptoFramework.RSAKeyPairSpec = {
    params: rsaCommSpec,
    sk: dIn,
    pk: eIn,
    algName: "RSA",
    specType: cryptoFramework.AsyKeySpecType.KEY_PAIR_SPEC,
  };
  return rsaKeyPairSpec;
}

// 生成RSA2048密钥对参数
function genRsa2048KeyPairSpec(): cryptoFramework.RSAKeyPairSpec {
  let nIn = BigInt(
    "18478533428762900543234234052165078897463517255891144687945154912560048989428973394502225231475673469493935673076685067666412374336644121661834634328568716128398010589214210242328473325052801924104401463496007910632384934591085795699377924655299831802536043790200563589400549497200957189436092639854513167455276408048482654440065204807879459064738847828290321155399964745065695320081378543586408514487910074079683525564599260683751683646405712006009189387522266386739458730786983547267804377576955002031599762775938196698277063712871930011053484489532696001735479019329660933285131374020059017332898114690445944576549"
  );
  let eIn = BigInt("65537");
  let dIn = BigInt(
    "13443367797579784472906374191268730591149473415683261174245648123593551364374079107625793014808865760593273402148759743980757062361671347127799770055874205659183190363964544152829383091462724002309744989516180102276157076935260650085211862081846405192552335715817353665234496972306343601367818009443948359153845315745091050102576900263842800919302048139131982882174917741979278274761193212951786209086143141198926907682548667292864640458922412016755237410423934679056828519631212431348847746741608018079408263762113939943821319770453677716209206087481504965313847534151150635490465180371871825563931626039033876425137"
  );
  return genRsaKeyPairSpec(nIn, eIn, dIn);
}

function genRsa2048CommonSpec(): cryptoFramework.RSACommonParamsSpec {
  let nIn = BigInt(
    "18478533428762900543234234052165078897463517255891144687945154912560048989428973394502225231475673469493935673076685067666412374336644121661834634328568716128398010589214210242328473325052801924104401463496007910632384934591085795699377924655299831802536043790200563589400549497200957189436092639854513167455276408048482654440065204807879459064738847828290321155399964745065695320081378543586408514487910074079683525564599260683751683646405712006009189387522266386739458730786983547267804377576955002031599762775938196698277063712871930011053484489532696001735479019329660933285131374020059017332898114690445944576549"
  );
  return genRsaCommonSpec(nIn);
}

function genRsaCommonSpec(nIn: bigint): cryptoFramework.RSACommonParamsSpec {
  let rsaCommSpec: cryptoFramework.RSACommonParamsSpec = {
    n: nIn,
    algName: "RSA",
    specType: cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC,
  };
  return rsaCommSpec;
}

function genRsa2048PubKetSpec(): cryptoFramework.RSAPubKeySpec {
  let nIn = BigInt(
    "18478533428762900543234234052165078897463517255891144687945154912560048989428973394502225231475673469493935673076685067666412374336644121661834634328568716128398010589214210242328473325052801924104401463496007910632384934591085795699377924655299831802536043790200563589400549497200957189436092639854513167455276408048482654440065204807879459064738847828290321155399964745065695320081378543586408514487910074079683525564599260683751683646405712006009189387522266386739458730786983547267804377576955002031599762775938196698277063712871930011053484489532696001735479019329660933285131374020059017332898114690445944576549"
  );
  let eIn = BigInt("65537");
  return genRSAPubKeySpec(nIn, eIn);
}

function genRSAPubKeySpec(nIn: bigint, eIn: bigint): cryptoFramework.RSAPubKeySpec {
  let rsaCommSpec: cryptoFramework.RSACommonParamsSpec = {
    n: nIn,
    algName: "RSA",
    specType: cryptoFramework.AsyKeySpecType.COMMON_PARAMS_SPEC,
  };
  let rsaPubKeySpec: cryptoFramework.RSAPubKeySpec = {
    params: rsaCommSpec,
    pk: eIn,
    algName: "RSA",
    specType: cryptoFramework.AsyKeySpecType.PUBLIC_KEY_SPEC,
  };
  return rsaPubKeySpec;
}

function genDsa2048PubKeySpecBigE(): cryptoFramework.DSAPubKeySpec {
  let dsaCommonSpec: cryptoFramework.DSACommonParamsSpec = genDsa2048CommonSpecBigE();
  let dsaPubKeySpec: cryptoFramework.DSAPubKeySpec = {
    algName: "DSA",
    specType: cryptoFramework.AsyKeySpecType.PUBLIC_KEY_SPEC,
    params: dsaCommonSpec,
    pk: BigInt(
      "2974320683131303383593011718103778438067248821010128068603330890682877434550441281827351603361334506610914048116228047158214093207291532728181748676811787843316027859373324322706845202765204260289964362553170484033902517855022371250354897430992714094652148720967777508481265194493537489752556929433399052957551421373353304195295773950194626096020536543310165869112300390873999312126377909122302697760566740696966174036865456319235321580616931347110147760623816495949862659419251353007558185295016129505360845025009080058771674461404631229857893492589646335484050582997233310521320078311463229120799046072712830367694"
    ),
  };
  return dsaPubKeySpec;
}

export {
  genEccKeySpec,
  genEccCommonSpec,
  genDsa2048CommonSpecBigE,
  genDsa2048KeyPairSpecBigE,
  genDsaKeyPairSpec,
  genDsa2048PubKeySpecBigE,
  genRsa2048KeyPairSpec,
  genRsaKeyPairSpec,
  genRsaCommonSpec,
  genRsa2048CommonSpec,
  genRSAPubKeySpec,
  genRsa2048PubKetSpec,
};
